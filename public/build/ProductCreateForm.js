import{b as o,c as m}from"./catchError.js";import{j as e}from"./app.js";import{r as i}from"./index.js";async function w(a=15,s="id,desc"){const r=new URLSearchParams({orderBy:s,limit:a.toString()});try{const{data:c}=await o.get(`api/products?${r}`);return c}catch(c){return m(c)}}const N=a=>(a/1e3).toLocaleString("pt-BR",{style:"currency",currency:"BRL"}),j=a=>new Date(a).toLocaleDateString("pt-BR",{year:"numeric",month:"2-digit",day:"2-digit"});async function b(a){try{return await o.delete(`api/products/${a}`),null}catch(s){return m(s)}}function P({products:a,onDelete:s}){const[r,c]=i.useState(a);i.useEffect(()=>{c(a)},[a]);const d=t=>async n=>{await b(t)===null&&(s==null||s())};return r?r==="error"?e.jsx("div",{className:"alert alert-warning",children:"Erro na API."}):e.jsx("div",{className:"col-12 col-lg-8",children:r.length===0?e.jsx("div",{className:"alert alert-warning",children:"Nenhum produto encontrado."}):e.jsx("div",{className:"row row-cols-1 row-cols-md-2 g-4",children:r.map(t=>{const n=t.id;return e.jsx("div",{className:"col",children:e.jsxs("div",{className:"card h-100 border-0 shadow-sm rounded-4",children:[e.jsxs("div",{className:"card-body d-flex flex-column",children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-start mb-2",children:[e.jsx("h6",{className:"card-title mb-0 fw-semibold",children:t.name}),e.jsx("span",{className:"badge text-bg-light border",children:N(t.price_times_thousand)})]}),e.jsxs("p",{className:"card-text text-muted small mt-2 mb-0",children:[e.jsx("i",{className:"fa-regular fa-clock me-1","aria-hidden":"true"}),"Cadastrado em ",j(t.created_at)]})]}),e.jsx("div",{className:"card-footer bg-white border-0 pt-0",children:e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsxs("span",{className:"badge rounded-pill text-bg-primary",children:["#",t.id]}),e.jsx("button",{type:"button",className:"btn btn-sm btn-outline-danger",onClick:d(n),children:e.jsx("i",{className:"fa-solid fa-trash"})})]})})]})},n)})})}):e.jsxs("div",{className:"alert alert-light border d-flex align-items-center gap-2",children:[e.jsx("span",{className:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"}),"Carregando produtos..."]})}async function g(a,s){try{const{data:r}=await o.post("api/products",{name:a,price:Number(s)??0});return r}catch(r){return m(r)}}function S({onCreate:a}){const[s,r]=i.useState(""),[c,d]=i.useState(""),[t,n]=i.useState(null),u=l=>{d(l.target.value)},p=l=>{r(l.target.value)},x=async l=>{l.preventDefault();const h=await g(s,c);if("error"in h){n(h.error);return}r(""),d(""),n(null),a==null||a()};return e.jsx("div",{className:"col-12 col-lg-4",children:e.jsx("div",{className:"card border-0 shadow-sm rounded-4 h-100",children:e.jsxs("div",{className:"card-body",children:[e.jsx("h5",{className:"card-title mb-3",children:"Cadastrar produto"}),t&&e.jsx("div",{className:"alert alert-danger py-2",children:t}),e.jsxs("form",{onSubmit:x,className:"vstack gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"prodName",className:"form-label",children:"Nome"}),e.jsx("input",{id:"prodName",className:"form-control w-100",placeholder:"Ex.: Teclado Mecânico",value:s,onChange:p})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"prodPrice",className:"form-label",children:"Preço"}),e.jsxs("div",{className:"input-group",children:[e.jsx("span",{className:"input-group-text",children:"R$"}),e.jsx("input",{id:"prodPrice",className:"form-control",placeholder:"Ex.: 199,90",value:c,onChange:u})]})]}),e.jsxs("button",{type:"submit",className:"btn btn-primary",children:[e.jsx("i",{className:"fa-solid fa-plus me-2","aria-hidden":"true"}),"Cadastrar"]})]})]})})})}export{S as P,P as a,w as p};
